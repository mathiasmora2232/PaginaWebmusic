<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Eventos | ConciertosAhora</title>
  <link rel="stylesheet" href="css/nav.css" />
  <link rel="stylesheet" href="css/events.css" />
</head>
<body>
  <header class="site-header">
    <div class="container">
      <h1 class="logo">ConciertosAhora</h1>
      <nav class="nav">
        <a href="index.html" class="btn-outline">Inicio</a>
        <a href="events.html" class="btn-outline">Eventos</a>
        <a href="organizers.html" class="btn-outline">Organizadores</a>
        <a href="create-event.html" class="btn">Crear evento</a>
        <a href="account.html" class="btn-outline">Mi cuenta</a>
        <a href="tickets.html" class="btn-outline">Mis tickets</a>
      </nav>
      <button class="menu-toggle" aria-label="Abrir menú">☰</button>
    </div>
  </header>

  <main>
    <section class="hero">
      <div class="container hero-inner">
        <div>
          <h2>Todos los eventos disponibles</h2>
          <p>Explora el calendario completo: filtra por fecha, género o ciudad y compra tus entradas.</p>
          <div class="cta-row">
            <a href="#list" class="btn">Ver listado</a>
            <a href="index.html#cta" class="btn-outline">Publicar evento</a>
          </div>
        </div>
      </div>
    </section>

    <section id="list" class="container section">
      <h2>Próximos eventos</h2>
      <div class="feature" id="filters">
        <div class="filters-row">
          <label>Buscar <input type="search" id="f-text" placeholder="Evento o lugar"/></label>
          <label>Género
            <select id="f-genre"><option value="">Todos</option><option>Rock</option><option>Pop</option><option>Electrónica</option><option>Indie</option><option>Jazz</option></select>
          </label>
          <label>Desde <input type="date" id="f-from"/></label>
          <label>Hasta <input type="date" id="f-to"/></label>
        </div>
      </div>
      <div class="grid" data-events-grid>
        <div class="loading">Cargando eventos...</div>
      </div>
    </section>

    <section class="section alt">
      <div class="container">
        <h2>¿Eres organizador?</h2>
        <p>Publica tu evento y empieza a vender entradas hoy mismo.</p>
        <a href="index.html#cta" class="btn">Crear evento</a>
      </div>
    </section>
  </main>

  <footer class="site-footer">
    <div class="container">
      <div>© 2025 ConciertosAhora</div>
      <div class="foot-links">
        <a href="#">Términos</a>
        <a href="#">Privacidad</a>
        <a href="#">Contacto</a>
      </div>
    </div>
  </footer>

  <script>
    const btn = document.querySelector('.menu-toggle');
    const nav = document.querySelector('.nav');
    btn && btn.addEventListener('click', () => nav.classList.toggle('open'));
  </script>
  <script src="js/events.js"></script>
  <script>
    // Filtros simples conectados al render
    (function(){
      const grid = document.querySelector('[data-events-grid]');
      const fText = document.getElementById('f-text');
      const fGenre = document.getElementById('f-genre');
      const fFrom = document.getElementById('f-from');
      const fTo = document.getElementById('f-to');
      let all = [];
      const render = (list)=>{
        grid.innerHTML = list.map(ev => {
          const imgDiv = ev.thumbImage
            ? `<div class=\"card-img poster\"><img src=\"${ev.thumbImage}\" alt=\"${ev.title}\"/></div>`
            : `<div class=\"card-img ${ev.thumbClass || ''}\"></div>`;
          return `
          <article class=\"card\" data-id=\"${ev.id}\">\n            ${imgDiv}\n            <div class=\"card-body\">\n              <h3>${ev.title}</h3>\n              <p>${ev.displayDate} · ${ev.venue} · Desde $${ev.priceFrom}</p>\n              <div class=\"card-actions\">\n                  <a href=\"checkout.html?id=${ev.id}\" class=\"btn-small\">Comprar</a>\n                  <a href=\"event.html?id=${ev.id}\" class=\"btn-link\">Detalles</a>\n              </div>\n            </div>\n          </article>`;
        }).join('');
      };
      function apply(){
        const q = (fText.value||'').toLowerCase();
        const g = fGenre.value;
        const f = fFrom.value;
        const t = fTo.value;
        const inRange = (d)=> {
          const dd = new Date(d);
          return (!f || dd >= new Date(f)) && (!t || dd <= new Date(t));
        };
        const filtered = all.filter(ev =>
          (!q || `${ev.title} ${ev.venue}`.toLowerCase().includes(q)) &&
          (!g || (ev.genres||[]).includes(g)) && inRange(ev.date)
        );
        render(filtered);
      }
      Promise.resolve(fetch('data/events.json').then(r=>r.json())).then(events=>{
        all = events;
        render(all);
      });
      ['input','change'].forEach(evt => {
        fText.addEventListener(evt, apply);
        fGenre.addEventListener(evt, apply);
        fFrom.addEventListener(evt, apply);
        fTo.addEventListener(evt, apply);
      });
    })();
  </script>
</body>
</html>